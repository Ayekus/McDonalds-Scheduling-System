<h1>Manager Dashboard</h1>

<div class="input-group mb-3">
  <input
    type="text"
    class="form-control"
    ngxDaterangepickerMd
    [locale]="locale"
    [(ngModel)]="selected"
    [singleDatePicker]="true"
    [autoApply]="true"
    placeholder="Select a Date"
  />
  <div class="input-group-append">
    <button type="submit" (click)="refreshData()" class="btn btn-warning"><i class="icofont-circled-right"></i></button>
  </div>
</div>

<div class="alert alert-success" role="alert" *ngIf="success">Schedule Saved Successfully!</div>

<div class="alert alert-success" role="alert" *ngIf="emailSuccess">Email Sent Successfully!</div>

<table *ngIf="dateTouched" class="table">
  <thead class="table-dark">
    <tr>
      <th scope="col"></th>
      <th scope="col">BK</th>
      <th scope="col">BEV</th>
      <th scope="col">FC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>5am - 9am</td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.BK[0]"
            *ngIf="availability.BK[0].length > 0"
          >
            <ng-container *ngFor="let person of availability.BK[0]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'BK', 0, availability.BK[0])"
            *ngIf="availability.BK[0].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.BK[0].length == 0">No Coverage</span>
      </td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.BEV[0]"
            *ngIf="availability.BEV[0].length > 0"
          >
            <ng-container *ngFor="let person of availability.BEV[0]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'BEV', 0, availability.BEV[0])"
            *ngIf="availability.BEV[0].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.BEV[0].length == 0">No Coverage</span>
      </td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.FC[0]"
            *ngIf="availability.FC[0].length > 0"
          >
            <ng-container *ngFor="let person of availability.FC[0]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'FC', 0, availability.FC[0])"
            *ngIf="availability.FC[0].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.FC[0].length == 0">No Coverage</span>
      </td>
    </tr>
    <tr>
      <td>9am - 1pm</td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.BK[1]"
            *ngIf="availability.BK[1].length > 0"
          >
            <ng-container *ngFor="let person of availability.BK[1]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'BK', 1, availability.BK[1])"
            *ngIf="availability.BK[1].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.BK[1].length == 0">No Coverage</span>
      </td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.BEV[1]"
            *ngIf="availability.BEV[1].length > 0"
          >
            <ng-container *ngFor="let person of availability.BEV[1]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'BEV', 1, availability.BEV[1])"
            *ngIf="availability.BEV[1].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.BEV[1].length == 0">No Coverage</span>
      </td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.FC[1]"
            *ngIf="availability.FC[1].length > 0"
          >
            <ng-container *ngFor="let person of availability.FC[1]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'FC', 1, availability.FC[1])"
            *ngIf="availability.FC[1].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.FC[1].length == 0">No Coverage</span>
      </td>
    </tr>
    <tr>
      <td>1pm - 5pm</td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.BK[2]"
            *ngIf="availability.BK[2].length > 0"
          >
            <ng-container *ngFor="let person of availability.BK[2]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'BK', 2, availability.BK[2])"
            *ngIf="availability.BK[2].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.BK[2].length == 0">No Coverage</span>
      </td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.BEV[2]"
            *ngIf="availability.BEV[2].length > 0"
          >
            <ng-container *ngFor="let person of availability.BEV[2]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'BEV', 2, availability.BEV[2])"
            *ngIf="availability.BEV[2].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.BEV[2].length == 0">No Coverage</span>
      </td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.FC[2]"
            *ngIf="availability.FC[2].length > 0"
          >
            <ng-container *ngFor="let person of availability.FC[2]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'FC', 2, availability.FC[2])"
            *ngIf="availability.FC[2].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.FC[2].length == 0">No Coverage</span>
      </td>
    </tr>
    <tr>
      <td>5pm - 9pm</td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.BK[3]"
            *ngIf="availability.BK[3].length > 0"
          >
            <ng-container *ngFor="let person of availability.BK[3]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'BK', 3, availability.BK[3])"
            *ngIf="availability.BK[3].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.BK[3].length == 0">No Coverage</span>
      </td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.BEV[3]"
            *ngIf="availability.BEV[3].length > 0"
          >
            <ng-container *ngFor="let person of availability.BEV[3]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'BEV', 3, availability.BEV[3])"
            *ngIf="availability.BEV[3].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.BEV[3].length == 0">No Coverage</span>
      </td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.FC[3]"
            *ngIf="availability.FC[3].length > 0"
          >
            <ng-container *ngFor="let person of availability.FC[3]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'FC', 3, availability.FC[3])"
            *ngIf="availability.FC[3].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.FC[3].length == 0">No Coverage</span>
      </td>
    </tr>
    <tr>
      <td>8pm - 11pm</td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.BK[4]"
            *ngIf="availability.BK[4].length > 0"
          >
            <ng-container *ngFor="let person of availability.BK[4]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'BK', 4, availability.BK[4])"
            *ngIf="availability.BK[4].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.BK[4].length == 0">No Coverage</span>
      </td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.BEV[4]"
            *ngIf="availability.BEV[4].length > 0"
          >
            <ng-container *ngFor="let person of availability.BEV[4]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'BEV', 4, availability.BEV[4])"
            *ngIf="availability.BEV[4].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.BEV[4].length == 0">No Coverage</span>
      </td>
      <td>
        <div class="input-group table-cell mb-3">
          <select
            class="form-select"
            id="allocation-algorithm"
            [(ngModel)]="schedule.FC[4]"
            *ngIf="availability.FC[4].length > 0"
          >
            <ng-container *ngFor="let person of availability.FC[4]">
              <option [value]="person.uid">{{ person.firstName }} {{ person.lastName }}</option>
            </ng-container>
          </select>
          <button
            class="btn btn-danger send-email"
            (click)="sendEmail(selectedDate, 'FC', 4, availability.FC[4])"
            *ngIf="availability.FC[4].length > 0"
          >
            <i class="icofont-email"></i>
          </button>
        </div>
        <span *ngIf="availability.FC[4].length == 0">No Coverage</span>
      </td>
    </tr>
  </tbody>
</table>
<div class="button-container">
  <button type="submit" (click)="setSchedule()" *ngIf="dateTouched" class="btn btn-warning">Save Schedule</button>
</div>
